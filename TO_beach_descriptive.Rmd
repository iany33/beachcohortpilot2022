---
title: "TO_beach_descriptive"
author: "Ian Young"
date: '2022-06-23'
output:
  html_document: default
  pdf_document: default
---

```{r include=FALSE}
pacman::p_load(
  rio,          # File import
  here,         # File locator
  skimr,        # get overview of data
  tidyverse,    # data management + ggplot2 graphics, 
  gtsummary,    # summary statistics and tests
  rstatix,      # statistics
  corrr,        # correlation analysis for numeric variables
  janitor,      # adding totals and percents to tables
  flextable,     # converting tables to HTML
  lubridate,     # working with dates
  forcats       # factors
)

load("~/R/.RData")

```

# Toronto Beach Cohort Descriptive Summary

```{r socio1, eval=FALSE, include=FALSE}
data %>% tabyl(age1)
data %>% tabyl(sex1)
data %>% tabyl(gender)
data %>% tabyl(income)
data %>% tabyl(education2)
data %>% tabyl(residence)
data %>% tabyl(ethnicity_arab)
data %>% tabyl(ethnicity_black)
data %>% tabyl(ethnicity_east_asian)
data %>% tabyl(ethnicity_indigenous)
data %>% tabyl(ethnicity_latin)
data %>% tabyl(ethnicity_south_asian)
data %>% tabyl(ethnicity_se_asian)
data %>% tabyl(ethnicity_white)
data %>% tabyl(ethnicity_other)
data %>% tabyl(ethnicity_other_s)
```

### Sociodemographics

```{r socio, echo=FALSE, warning=FALSE}
data %>% 
  select(age1, gender, income, education2, residence, ethnicity_arab, ethnicity_black, 
         ethnicity_east_asian, ethnicity_indigenous, ethnicity_latin, ethnicity_south_asian, 
         ethnicity_se_asian, ethnicity_white) %>% 
  tbl_summary()  
```

### Baseline health and beach activities 

```{r baseline, echo=FALSE, warning=FALSE}
data %>% 
  select(base_agi, base_resp, base_ear, base_eye, base_skin, cond_GI, cond_resp, cond_skin, 
         cond_allergy, cond_immune, cond_none, prev_act1, beach_exp_algae, beach_exp_sunscreen, 
         beach_exp_repellent, beach_exp_food) %>% 
  tbl_summary()
```

### Water and sand exposures

```{r exposures, echo=FALSE, warning=FALSE}
data %>% 
  select(water_contact, water_act_swim, water_act_surf, water_act_kite, water_act_wind, water_act_wake, 
         water_act_ski, water_act_paddle, water_act_snorkel, water_act_dive, water_act_wade, 
         water_act_sail, water_act_boat, water_act_fish, water_act_canoe, water_act_kayak, 
         water_act_row, water_act_other, water_exp_face, water_exp_mouth, sand1, sand_act_dig, 
         sand_act_bury, sand_act_other, sand_mouth1) %>% 
  tbl_summary()
```

## Summarize follow-up survey results

```{r follow prep, warning=FALSE, include=FALSE}
data_grouped <- data %>% group_by(house_id) %>% 
  summarize(n_cases  = n(), n_follow = sum(follow==1, na.rm=T),
            follow_percent = sum((n_follow/n_cases)*100))

data_follow <- data[ which(data$follow == "Yes"), ]
```


```{r follow-up, warning=FALSE, echo=FALSE}
data %>% tabyl(follow)

data_follow %>% 
  select(agi, diarrhea, respiratory, ear_infection, eye_infection, skin_infection, misswork, 
         med_antibiotics, med_otc, med_none, healthcare1, emergency, hospital) %>% 
  tbl_summary()
```

## Compare sociodemographics of those who completed follow-up survey vs. not
### Sociodemographic comparison

```{r compare, echo=FALSE, warning=FALSE}
data %>% 
  select(age1, gender, income, education2, residence, ethnicity_arab, ethnicity_black, 
         ethnicity_east_asian, ethnicity_indigenous, ethnicity_latin, ethnicity_south_asian, 
         ethnicity_se_asian, ethnicity_white, follow) %>% 
  tbl_summary(by = follow) %>% add_p()
```

### Baseline health and activity comparison

```{r compare2, echo=FALSE, warning=FALSE}
data %>% 
  select(base_agi, base_resp, base_ear, base_eye, base_skin, cond_GI, cond_resp, cond_skin, 
         cond_allergy, cond_immune, cond_none, prev_act1, beach_exp_algae, beach_exp_sunscreen, 
         beach_exp_repellent, beach_exp_food, follow) %>% 
  tbl_summary(by = follow) %>% add_p()
```

### Water and sand exposure comparison

```{r compare3, echo=FALSE, warning=FALSE}
data %>% 
  select(water_contact, water_act_swim, water_act_surf, water_act_kite, water_act_wind, water_act_wake, 
         water_act_ski, water_act_paddle, water_act_snorkel, water_act_dive, water_act_wade, 
         water_act_sail, water_act_boat, water_act_fish, water_act_canoe, water_act_kayak, 
         water_act_row, water_act_other, water_exp_face, water_exp_mouth, sand1, sand_act_dig, 
         sand_act_bury, sand_act_other, sand_mouth1, follow) %>% 
  tbl_summary(by = follow) %>% add_p()
```

## Cross-tab water activities with face and mouth contact
### Water exposures by head immersion

```{r face contact, echo=FALSE, warning=FALSE}
data %>% 
  select(water_act_swim, water_act_surf, water_act_kite, water_act_wind, water_act_wake, 
         water_act_ski, water_act_paddle, water_act_snorkel, water_act_dive, water_act_wade, 
         water_act_sail, water_act_boat, water_act_fish, water_act_canoe, water_act_kayak, 
         water_act_row, water_act_other, water_exp_face) %>% 
  tbl_summary(by = water_exp_face)
```

### Water exposures by swallowing water

```{r mouth contact, echo=FALSE, warning=FALSE}
data %>% 
  select(water_act_swim, water_act_surf, water_act_kite, water_act_wind, water_act_wake, 
         water_act_ski, water_act_paddle, water_act_snorkel, water_act_dive, water_act_wade, 
         water_act_sail, water_act_boat, water_act_fish, water_act_canoe, water_act_kayak, 
         water_act_row, water_act_other, water_exp_mouth) %>% 
  tbl_summary(by = water_exp_mouth)
```



